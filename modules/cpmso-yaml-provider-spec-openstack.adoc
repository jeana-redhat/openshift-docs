// Module included in the following assemblies:
//
// * machine_management/cpmso-configuration.adoc

:_mod-docs-content-type: REFERENCE
[id="cpmso-yaml-provider-spec-openstack_{context}"]
= Sample {rh-openstack} provider specification

When you create a control plane machine set for an existing cluster, the provider specification must match the `providerSpec` configuration in the control plane machine custom resource (CR) that is created by the installation program.

In the following example, `<infrastructure_name>` is the infrastructure name that is based on the cluster ID that you set when you provisioned the cluster. If you have the OpenShift CLI installed, you can obtain the infrastructure name by running the following command:

[source,terminal]
----
$ oc get -o jsonpath='{.status.infrastructureName}{"\n"}' infrastructure cluster
----

.Sample OpenStack `providerSpec` values
[source,yaml]
----
apiVersion: machine.openshift.io/v1
kind: ControlPlaneMachineSet
metadata:
  name: cluster
  namespace: openshift-machine-api
spec:
# ...
  template:
# ...
      spec:
        providerSpec:
          value:
            apiVersion: machine.openshift.io/v1alpha1
            cloudName: openstack
            cloudsSecret:
              name: openstack-cloud-credentials # <1>
              namespace: openshift-machine-api
            flavor: m1.xlarge # <2>
            image: <infrastructure_name>-rhcos
            kind: OpenstackProviderSpec # <3>
            metadata:
              creationTimestamp: null
            networks:
            - filter: {}
              subnets:
              - filter:
                  name: <infrastructure_name>-nodes
                  tags: openshiftClusterID=<infrastructure_name>
            securityGroups:
            - filter: {}
              name: <infrastructure_name>-master # <4>
            serverGroupName: <infrastructure_name>-master
            serverMetadata:
              Name: <infrastructure_name>-master
              openshiftClusterID: <infrastructure_name>
            tags:
            - openshiftClusterID=<infrastructure_name>
            trunk: true
            userDataSecret:
              name: master-user-data
----
<1> The secret name for the cluster. Do not change this value.
<2> The {rh-openstack} flavor type for the control plane.
<3> The {rh-openstack} cloud provider platform type. Do not change this value.
<4> The control plane machines security group.