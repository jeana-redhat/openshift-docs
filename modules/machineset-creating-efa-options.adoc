// Module included in the following assemblies:
//
// * machine_management/creating_machinesets/creating-machineset-aws.adoc

:_content-type: PROCEDURE
[id="machineset-creating-efa-options_{context}"]
= Creating machines that use an AWS Elastic Fabric Adapter

You can deploy compute machines that use an AWS Elastic Fabric Adapter (EFA) by adding the `networkInterfaceType` field to the machine set YAML file for your compute machines.

[NOTE]
====
Machines that use an EFA must belong to security groups that allow all traffic between all hosts in the security group. You might find it helpful to create a dedicated security group for machines that use an EFA.

You can manually configure your security groups to support the use of an EFA by using the AWS Management Console or the AWS CLI. For more information, see the Amazon EC2 documentation about https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/working-with-security-groups.html#updating-security-group-rules[updating security group rules].
====

.Prerequisites

* You have configured security groups to support the use of an EFA.

.Procedure

. In a text editor, open the YAML file for an existing AWS machine set or create a new one.

. Add the following line under the `providerSpec` field:
+
[source,yaml]
----
providerSpec:
  value:
    networkInterfaceType: EFA <1>
----
<1> Specify the type of network interface to use. To use an EFA, set this value to `EFA`. To use a standard Elastic Network Adapter (ENA), set this value to `ENA`. If no value is specified, machines deployed by the machine set use a standard ENA.

.Verification

. In the AWS Management Console, locate an EC2 instance that the machine set deployed.

. On the *Networking* tab, verify that the *Interface type* value under *Network interfaces* is `Elastic Fabric Adapter`.

.Next steps

* If you plan to run MPI workloads with the EFA node, you must install additional software. For more information, see "Enabling MPI workloads that use an AWS Elastic Fabric Adapter".